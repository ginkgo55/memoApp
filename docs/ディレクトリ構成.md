# フロントエンド ディレクトリ構成

本ドキュメントは、手書きメモアプリのフロントエンド（Next.js）におけるディレクトリとコンポーネントの構成を定義します。

## 1. 設計思想

コンポーネントを役割ごとに分割し、再利用性とメンテナンス性を高めることを目指します。

- **責務の分離:** 各コンポーネントは単一の責任を持つように設計します。例えば、「描画する」コンポーネントと「描画ツールを管理する」コンポーネントは分離します。
- **Presentational / Container:** UIの見た目のみ責務を持つコンポーネント (Presentational) と、ロジック（データ取得、状態管理など）を責務に持つコンポーネント (Container) を意識的に分離します。Next.jsのApp Routerでは、Server ComponentsとClient Componentsの使い分けがこれに近いです。
- **ディレクトリ構造:** 機能や役割に基づいてコンポーネントやロジックをグルーピングします。

---

## 2. ディレクトリ構造

Next.jsの`app`ディレクトリをベースに、以下のような構造を基本とします。

```plaintext
memoApp
├── app/
│   ├── auth/             # 認証関連ページ・ロジック
│   │   ├── actions.ts      # 認証関連のServer Actions
│   │   ├── login/page.tsx
│   │   └── signup/page.tsx
│   ├── main/             # メイン機能ページ (ヘッダーなどのレイアウトを共有)
│   │   ├── layout.tsx      # メイン機能用のレイアウト
│   │   ├── page.tsx        # メモ一覧ページ
│   │   └── memo/
│   │       ├── actions.ts      # メモ関連のServer Actions
│   │       ├── new/page.tsx      # 新規メモ作成ページ
│   │       └── [id]/page.tsx   # メモ編集ページ
│   ├── api/              # APIエンドポイント
│   │   └── ...
│   └── layout.tsx          # ルートレイアウト
│
├── components/
│   ├── ui/                 # 再利用可能なUI部品 (shadcn/uiなど)
│   │   ├── button.tsx
│   │   ├── dialog.tsx      # モーダル用
│   │   └── card.tsx        # カードUIのベース
│   │
│   ├── features/           # アプリケーションの機能単位のコンポーネント
│   │   └── ...
│   │
│   ├── layouts/            # ページ全体のレイアウト用コンポーネント
│   │   └── ...
│   │
│   └── __tests__/          # テストコード
│       └── ...
│
└── lib/                    # アプリケーション全体で利用する共通ライブラリ
    ├── actions/
    │   └── memoActions.ts  # メモ関連のクライアント向けアクション
    ├── supabase/
    │   └── server.ts       # Supabaseのサーバークライアント
    └── database.types.ts   # Supabaseの型定義
```

---

## 3. 主要なディレクトリ・ファイルの役割

### `app/`

Next.jsのApp Routerの規約に沿ったルーティングとページ、ロジックを配置します。

- **`auth/actions.ts`, `main/memo/actions.ts`**:
  - 各機能（ドメイン）に閉じたサーバーサイドの処理を記述するServer Actionsです。フォームからのデータ受け取りやデータベースとのやり取りなど、クライアントを介さずに実行したい処理をここに記述します。

### `lib/`

特定の機能に依存せず、アプリケーション全体で利用される共通のモジュールを配置します。

- **`supabase/`**: Supabaseに関する設定やクライアントの初期化処理をまとめます。
- **`database.types.ts`**: `supabase gen types typescript`コマンドで自動生成された、データベースのテーブルやカラムの型定義ファイルです。
- **`actions/`**: 主にクライアント側で呼び出される、複数のコンポーネントから利用されるような共通アクションを配置します。

### `components/`

Reactコンポーネントを配置します。役割に応じて`ui`, `features`, `layouts`に分類します。

- **`ui/`**: 特定の機能に依存しない、汎用的なUIパーツです。
- **`layouts/`**: ヘッダーやフッターなど、ページの骨格となるレイアウトコンポーネントです。
- **`features/`**: アプリケーションの各機能に特化した、具体的なコンポーネント群です。（例: `features/editor/Editor.tsx`）

---

## 4. ページとコンポーネントの関連

| ページ (URL)             | 主な利用コンポーネント/ロジック                               | 説明                               |
| ------------------------ | ---------------------------------------------------- | ---------------------------------- |
| `/login`, `/signup`      | `features/auth/AuthForm.tsx`, `app/auth/actions.ts`  | ユーザー認証ページ                 |
| `/` (ルート)             | `layouts/Header.tsx`, `features/memo/MemoList.tsx`   | ログイン後のメモ一覧ページ         |
| `/memo/new`, `/memo/[id]`| `layouts/Header.tsx`, `features/editor/Editor.tsx`, `app/main/memo/actions.ts` | メモの新規作成・編集ページ         |

